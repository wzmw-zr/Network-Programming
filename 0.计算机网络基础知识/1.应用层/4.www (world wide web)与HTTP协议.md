# `www` (world wide web)与`HTTP`协议

`HTTP`(HyperText Treansfer Protocol)协议就是**浏览器与服务器之间的应用层通信协议**。

## 一、`HTTP` 协议的作用

+ `HTTP`协议定义了浏览器如何请求服务器，服务器如何相应浏览器(**请求与响应报文**)
+ `HTTP`协议规定了浏览器与服务器之间的**请求与响应报文的格式与规则**



## 二、`HTTP`协议的工作流程

`HTTP`协议采用C/S结构，基于`TCP`协议。`HTTP`协议的工作流程如下：

+ `HTTP`客户端发起到服务器的`TCP`连接，使用**默认端口80**，服务器和客户端各有一个套接字与之对应
+ **`HTTP`客户端经其套接字向服务器发送请求报文**。报文中包含要请求的对象。
+ `HTTP`服务器接受该报文，从服务器上检索对象，**在`HTTP`响应报文中封装该对象，并通过套接字传送。**
+ **`HTTP`服务器通知客户端断开`TCP`连接**
+ **`HTTP`客户端断开`TCP`连接**



## 三、`HTTP`协议的特点

+ `HTTP`是**无状态协议**，服务器不存储关于用户的状态信息。**浏览器用Cookie和数据库的方式跟踪用户的活动,服务器也有相关数据库。**
+ `HTTP`**采用`TCP`作为运输层协议**，保证**数据的可靠传输**
+ `HTTP`**本身是无连接的**，通信双方在交换`HTTP`报文之前不需要先建立`HTTP`连接
+ **`HTTP`服务器总是处于打开状态，有一个固定`IP`**
+ `HTTP`**可以使用非持久连接，也可以使用持久连接**



## 四、非持久连接与持久连接

`HTTP`既可以使用非持久连接，也可以使用持久连接。

### 1.非持久连接

对于非持久连接，每个网页元素对象的传输都需要单独建立一个`TCP`连接。

请求一个万维网文档的时间=文档传输时间+2 × `RTT`

### 2.持久连接

持久连接是指服务器在发送响应之后仍然保持这条连接，使得客户端与服务器可以继续在这条连接上传送后续的`HTTP`请求和接受文档。

持久连接分为：

+ **非流水线方式**：用户在收到前一个响应后才可以发出下一个请求，每个请求都会有一个`RTT`延迟
+ **流水线方式**：**默认使用流水线方式**，可以**连续发送请求，所有请求总共一个``RTT`延迟**



## 五、`HTTP`的报文结构

有两类`HTTP`报文：

+ **请求报文：**从客户端向服务器发送的请求报文
+ **响应报文：**从服务器到客户的回答

### 1.`HTTP`请求报文的结构

![HTTP1](./HTTP1.png)

**常见的请求方法：**

| 请求方法 | 用途                               |
| -------- | ---------------------------------- |
| GET      | 请求获取数据                       |
| POST     | 上传表单(用户的身份验证信息)       |
| HEAD     | 开发时使用，仅查看请求数据是否存在 |
| PUT      | 上传数据给服务器存储               |
| DELETE   | 告知服务器删除指定数据             |



### 2.`HTTP`响应报文

![HTTP2](./HTTP2.png)

`HTTP`响应报文常见的状态码与短语：

| 状态码 | 短语                       |
| ------ | -------------------------- |
| 200    | OK                         |
| 301    | Moved Permanently          |
| 400    | Bad Request                |
| 404    | Not Found                  |
| 505    | HTTP Version Not Supported |



## 六、代理服务器(WEB缓存器)

使用代理服务器：

+ **大大减少了客户请求的响应时间**
+ **减少了机构的接入链路到因特网的通信量**
+ **从整体上大大减少因特网上的WEB流量**，改善所有应用的性能

